After I solved it, I looked at other solutions. Dismayingly simple compared to what I did.